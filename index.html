<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Cedar ‚Äî TEIM Assistant | Tribal Economic Impact Platform</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --ochre: #cc7722;
  --sage: #87a96b;
  --stone: #6b5b73;
  --earth: #3e2723;
  --cream: #f7f3e9;
  --cream-dark: #ebe5d8;
  --charcoal: #2e2e2e;
  --territory: #059669;
  --territory-soft: rgba(5, 150, 105, 0.08);
  --territory-glow: rgba(5, 150, 105, 0.15);
  --white: #fdfaf5;
  --font-display: 'Crimson Text', Georgia, serif;
  --font-body: 'DM Sans', system-ui, sans-serif;
  --ease: cubic-bezier(.4, 0, .2, 1);
  --shadow-soft: 0 4px 20px rgba(62, 39, 35, 0.08);
  --shadow-card: 0 2px 12px rgba(62, 39, 35, 0.06);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: var(--font-body);
  line-height: 1.65;
  color: var(--earth);
  background: var(--cream);
  min-height: 100vh;
}

/* NAV */
nav {
  position: sticky; top: 0; z-index: 100;
  background: rgba(253, 250, 245, 0.97);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(229, 221, 207, 0.6);
  padding: 0.8rem 1.4rem;
  display: flex; align-items: center; justify-content: space-between;
}

.brand {
  font-size: 0.78rem; font-weight: 700;
  letter-spacing: 0.06em; text-transform: uppercase;
  color: var(--earth); text-decoration: none; line-height: 1.3;
}
.brand span {
  display: block; font-size: 0.6rem;
  color: var(--territory); font-weight: 700; letter-spacing: 0.08em;
}

.nav-links { display: flex; align-items: center; gap: 0.25rem; }
.nav-links a {
  padding: 0.5rem 0.85rem; font-size: 0.8rem;
  font-weight: 600; color: var(--stone);
  text-decoration: none; border-radius: 8px;
  transition: all 0.24s var(--ease);
}
.nav-links a:hover { background: rgba(135, 169, 107, 0.12); }
.nav-links a.active {
  background: linear-gradient(135deg, var(--territory-soft), rgba(135, 169, 107, 0.12));
  color: var(--territory);
  box-shadow: inset 0 0 0 1px rgba(5, 150, 105, 0.2);
}

/* PAGE LAYOUT */
.page-wrap {
  max-width: 1400px;
  margin: 0 auto;
  padding: 1.5rem 1.4rem 2rem;
}

.page-header {
  display: flex; align-items: flex-start; justify-content: space-between;
  gap: 1rem; margin-bottom: 1.25rem; flex-wrap: wrap;
}

.page-title-block h1 {
  font-family: var(--font-display);
  font-size: 1.85rem; line-height: 1.2;
  color: var(--earth); margin-bottom: 0.25rem;
}

.page-subtitle {
  font-size: 0.88rem; color: var(--stone); max-width: 480px;
}

.prototype-badge {
  display: inline-flex; align-items: center; gap: 0.4rem;
  background: linear-gradient(135deg, var(--stone), var(--territory));
  color: #fff; padding: 0.4rem 0.85rem; border-radius: 999px;
  font-size: 0.65rem; font-weight: 600; letter-spacing: 0.06em;
  box-shadow: 0 2px 10px rgba(5, 150, 105, 0.25);
}

.prototype-badge::before {
  content: '';
  width: 6px; height: 6px; border-radius: 50%;
  background: #a7f3d0;
  box-shadow: 0 0 0 2px rgba(167, 243, 208, 0.3);
}

/* CHAT CONTAINER */
.chat-container {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 1.25rem;
  min-height: 580px;
}

@media (max-width: 900px) {
  .chat-container {
    grid-template-columns: 1fr;
  }
}

/* SIDEBAR */
.sidebar {
  display: flex; flex-direction: column; gap: 1rem;
}

.cedar-profile {
  background: var(--white);
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-radius: 14px;
  padding: 1.1rem;
  box-shadow: var(--shadow-card);
}

.cedar-avatar-row {
  display: flex; align-items: center; gap: 0.75rem;
  margin-bottom: 0.65rem;
}

.cedar-avatar {
  width: 44px; height: 44px;
  border-radius: 12px;
  background: linear-gradient(145deg, var(--territory), var(--sage));
  display: flex; align-items: center; justify-content: center;
  color: #fff; font-weight: 700; font-size: 0.9rem;
  letter-spacing: 0.03em;
  box-shadow: 0 4px 14px rgba(5, 150, 105, 0.3);
  position: relative;
}

.cedar-avatar::after {
  content: '';
  position: absolute; bottom: -2px; right: -2px;
  width: 12px; height: 12px; border-radius: 50%;
  background: #10b981;
  border: 2px solid var(--white);
}

.cedar-name {
  font-weight: 700; font-size: 0.95rem; color: var(--earth);
}

.cedar-role {
  font-size: 0.72rem; color: var(--stone);
}

.cedar-desc {
  font-size: 0.78rem; color: var(--charcoal);
  line-height: 1.5;
}

.cedar-badges {
  display: flex; gap: 0.4rem; flex-wrap: wrap;
  margin-top: 0.6rem;
}

.cedar-badge {
  font-size: 0.62rem; text-transform: uppercase;
  letter-spacing: 0.07em; font-weight: 600;
  padding: 0.3rem 0.55rem; border-radius: 999px;
  background: var(--territory-soft);
  color: var(--territory);
  border: 1px solid rgba(5, 150, 105, 0.2);
}

/* Topic Cards */
.topics-section {
  flex: 1;
}

.topics-label {
  font-size: 0.68rem; text-transform: uppercase;
  letter-spacing: 0.1em; color: var(--stone);
  margin-bottom: 0.5rem; font-weight: 600;
}

.topic-cards {
  display: flex; flex-direction: column; gap: 0.5rem;
}

.topic-card {
  background: var(--white);
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-radius: 10px;
  padding: 0.75rem 0.85rem;
  cursor: pointer;
  transition: all 0.2s var(--ease);
  position: relative;
  overflow: hidden;
}

.topic-card::before {
  content: '';
  position: absolute; left: 0; top: 0; bottom: 0;
  width: 3px; background: var(--ochre);
  opacity: 0; transition: opacity 0.2s;
}

.topic-card:hover {
  border-color: rgba(204, 119, 34, 0.4);
  box-shadow: var(--shadow-soft);
  transform: translateX(2px);
}

.topic-card:hover::before { opacity: 1; }

.topic-card-title {
  font-size: 0.8rem; font-weight: 600;
  color: var(--earth); margin-bottom: 0.15rem;
}

.topic-card-sub {
  font-size: 0.7rem; color: var(--stone);
}

/* MAIN CHAT PANEL */
.chat-main {
  background: var(--white);
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-radius: 16px;
  display: flex; flex-direction: column;
  box-shadow: var(--shadow-soft);
  overflow: hidden;
}

/* Chat Header */
.chat-header {
  padding: 0.85rem 1.1rem;
  border-bottom: 1px solid rgba(229, 221, 207, 0.6);
  display: flex; align-items: center; justify-content: space-between;
  background: linear-gradient(180deg, var(--white), var(--cream));
}

.chat-header-left {
  display: flex; align-items: center; gap: 0.6rem;
}

.chat-mode-indicator {
  display: flex; align-items: center; gap: 0.35rem;
  font-size: 0.72rem; color: var(--territory); font-weight: 600;
}

.chat-mode-indicator::before {
  content: '';
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--territory);
  box-shadow: 0 0 0 3px var(--territory-glow);
}

.chat-session-label {
  font-size: 0.72rem; color: var(--stone);
  padding: 0.3rem 0.6rem;
  border: 1px dashed rgba(107, 91, 115, 0.4);
  border-radius: 999px;
}

.chat-actions {
  display: flex; gap: 0.4rem;
}

.chat-action-btn {
  padding: 0.4rem 0.65rem;
  font-size: 0.68rem; font-weight: 600;
  color: var(--stone);
  background: transparent;
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s var(--ease);
}

.chat-action-btn:hover {
  background: var(--cream);
  border-color: var(--ochre);
  color: var(--ochre);
}

/* Chat Body */
.chat-body {
  flex: 1;
  padding: 1rem 1.1rem;
  overflow-y: auto;
  display: flex; flex-direction: column; gap: 0.85rem;
  background: 
    radial-gradient(circle at 10% 90%, var(--territory-glow) 0%, transparent 50%),
    radial-gradient(circle at 90% 10%, rgba(204, 119, 34, 0.06) 0%, transparent 50%),
    var(--cream);
}

.chat-body::-webkit-scrollbar { width: 6px; }
.chat-body::-webkit-scrollbar-track { background: transparent; }
.chat-body::-webkit-scrollbar-thumb {
  background: rgba(107, 91, 115, 0.25);
  border-radius: 999px;
}

/* Chat Intro */
.chat-intro {
  text-align: center;
  padding: 1.5rem 1rem;
  max-width: 400px;
  margin: 0 auto;
}

.chat-intro-icon {
  width: 48px; height: 48px;
  margin: 0 auto 0.75rem;
  border-radius: 14px;
  background: linear-gradient(145deg, var(--territory), var(--sage));
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 6px 20px rgba(5, 150, 105, 0.25);
}

.chat-intro-icon svg {
  width: 24px; height: 24px; color: #fff;
}

.chat-intro h3 {
  font-family: var(--font-display);
  font-size: 1.15rem; color: var(--earth);
  margin-bottom: 0.35rem;
}

.chat-intro p {
  font-size: 0.8rem; color: var(--stone);
  line-height: 1.5;
}

/* Messages */
.message-row {
  display: flex; gap: 0.6rem;
  animation: fadeSlideIn 0.3s var(--ease);
}

@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

.message-row.user { justify-content: flex-end; }

.message-avatar {
  width: 28px; height: 28px;
  border-radius: 8px;
  background: linear-gradient(145deg, var(--territory), var(--sage));
  display: flex; align-items: center; justify-content: center;
  color: #fff; font-size: 0.6rem; font-weight: 700;
  flex-shrink: 0;
}

.message-row.user .message-avatar {
  background: linear-gradient(145deg, var(--stone), var(--ochre));
  order: 2;
}

.message-content {
  max-width: 70%;
  display: flex; flex-direction: column; gap: 0.2rem;
}

.message-bubble {
  padding: 0.7rem 0.9rem;
  border-radius: 12px;
  font-size: 0.84rem;
  line-height: 1.55;
  white-space: pre-wrap;
}

.message-row.bot .message-bubble {
  background: var(--white);
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-bottom-left-radius: 4px;
  color: var(--charcoal);
}

.message-row.user .message-bubble {
  background: linear-gradient(135deg, var(--territory), #047857);
  color: #fff;
  border-bottom-right-radius: 4px;
  box-shadow: 0 4px 12px rgba(5, 150, 105, 0.25);
}

.message-meta {
  font-size: 0.65rem;
  color: var(--stone);
  padding: 0 0.2rem;
}

.message-row.user .message-meta { text-align: right; }

/* Typing Indicator */
.typing-indicator {
  display: flex; align-items: center; gap: 0.4rem;
  padding: 0.6rem 0.8rem;
  background: var(--white);
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-radius: 12px;
  width: fit-content;
}

.typing-dots {
  display: flex; gap: 3px;
}

.typing-dots span {
  width: 6px; height: 6px;
  border-radius: 50%;
  background: var(--territory);
  animation: typingBounce 1.2s infinite;
}

.typing-dots span:nth-child(2) { animation-delay: 0.15s; }
.typing-dots span:nth-child(3) { animation-delay: 0.3s; }

@keyframes typingBounce {
  0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
  30% { transform: translateY(-4px); opacity: 1; }
}

.typing-text {
  font-size: 0.72rem; color: var(--stone); font-style: italic;
}

/* CHAT INPUT */
.chat-input-area {
  padding: 0.75rem 1rem;
  border-top: 1px solid rgba(229, 221, 207, 0.6);
  background: var(--white);
}

.quick-prompts {
  display: flex; flex-wrap: wrap; gap: 0.4rem;
  margin-bottom: 0.6rem;
}

.quick-prompt {
  font-size: 0.68rem;
  padding: 0.35rem 0.65rem;
  border: 1px dashed rgba(107, 91, 115, 0.4);
  border-radius: 999px;
  background: transparent;
  color: var(--stone);
  cursor: pointer;
  transition: all 0.15s var(--ease);
}

.quick-prompt:hover {
  border-style: solid;
  border-color: var(--territory);
  color: var(--territory);
  background: var(--territory-soft);
}

.input-row {
  display: flex; gap: 0.6rem; align-items: center;
}

.chat-input {
  flex: 1;
  padding: 0.7rem 1rem;
  font-size: 0.88rem;
  font-family: var(--font-body);
  border: 1px solid rgba(229, 221, 207, 0.8);
  border-radius: 12px;
  background: var(--cream);
  color: var(--earth);
  outline: none;
  transition: all 0.2s var(--ease);
}

.chat-input::placeholder { color: var(--stone); }

.chat-input:focus {
  border-color: var(--territory);
  box-shadow: 0 0 0 3px var(--territory-glow);
  background: var(--white);
}

.send-btn {
  padding: 0.7rem 1.1rem;
  font-size: 0.8rem; font-weight: 600;
  font-family: var(--font-body);
  background: linear-gradient(135deg, var(--territory), #047857);
  color: #fff;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  display: flex; align-items: center; gap: 0.4rem;
  box-shadow: 0 4px 14px rgba(5, 150, 105, 0.3);
  transition: all 0.2s var(--ease);
}

.send-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 20px rgba(5, 150, 105, 0.4);
}

.send-btn svg {
  width: 16px; height: 16px;
}

/* DESIGN NOTES PANEL */
.design-notes {
  margin-top: 2rem;
  padding: 1.5rem;
  background: var(--white);
  border: 2px dashed rgba(204, 119, 34, 0.4);
  border-radius: 14px;
}

.design-notes h2 {
  font-family: var(--font-display);
  font-size: 1.25rem;
  color: var(--ochre);
  margin-bottom: 0.75rem;
  display: flex; align-items: center; gap: 0.5rem;
}

.design-notes h2::before {
  content: 'üìã';
}

.design-notes h3 {
  font-size: 0.85rem;
  color: var(--earth);
  margin: 1rem 0 0.4rem;
  padding-top: 0.75rem;
  border-top: 1px solid rgba(229, 221, 207, 0.6);
}

.design-notes h3:first-of-type {
  border-top: none;
  padding-top: 0;
  margin-top: 0.5rem;
}

.design-notes ul {
  margin-left: 1.2rem;
  font-size: 0.82rem;
  color: var(--charcoal);
}

.design-notes li {
  margin-bottom: 0.35rem;
  line-height: 1.5;
}

.design-notes code {
  font-size: 0.78rem;
  background: var(--cream);
  padding: 0.15rem 0.4rem;
  border-radius: 4px;
  color: var(--territory);
}

.design-notes .callout {
  background: var(--territory-soft);
  border-left: 3px solid var(--territory);
  padding: 0.75rem 1rem;
  margin: 0.75rem 0;
  border-radius: 0 8px 8px 0;
  font-size: 0.82rem;
}

/* FOOTER */
footer {
  background: var(--earth);
  color: #fdfaf5;
  padding: 1.4rem;
  text-align: center;
  margin-top: 2rem;
}

footer p { font-size: 0.85rem; margin-bottom: 0.15rem; }
footer .tagline { opacity: 0.8; font-size: 0.75rem; }
</style>
</head>

<body>

<nav>
  <a href="#" class="brand">
    Tribal Economic Impact Platform
    <span>Powered by TEIM‚Ñ¢</span>
  </a>
  <div class="nav-links">
    <a href="#">Home</a>
    <a href="#">Model</a>
    <a href="#">Demo</a>
    <a href="#" class="active">Cedar</a>
    <a href="#">Contact</a>
  </div>
</nav>

<div class="page-wrap">
  
  <header class="page-header">
    <div class="page-title-block">
      <h1>Ask Cedar</h1>
      <p class="page-subtitle">
        Prototype of Francesca‚Äôs chatbot deliverable ‚Äî a TEIM-aware assistant for tribal decision-makers.
      </p>
    </div>
    <div class="prototype-badge">Prototype Preview</div>
  </header>

  <div class="chat-container">
    
    <!-- Sidebar -->
    <aside class="sidebar">
      
      <div class="cedar-profile">
        <div class="cedar-avatar-row">
          <div class="cedar-avatar">CE</div>
          <div>
            <div class="cedar-name">Cedar</div>
            <div class="cedar-role">TEIM Guide</div>
          </div>
        </div>
        <p class="cedar-desc">
          I help translate TEIM outputs, multipliers, and federal Indian law into language that works for council members, finance teams, and enterprise leadership.
        </p>
        <div class="cedar-badges">
          <span class="cedar-badge">TEIM-Powered</span>
          <span class="cedar-badge">Tribal Law</span>
        </div>
      </div>

      <div class="topics-section">
        <p class="topics-label">Start with a topic</p>
        <div class="topic-cards">
          <div class="topic-card" data-topic="teim_intro">
            <div class="topic-card-title">What is TEIM?</div>
            <div class="topic-card-sub">Plain-language overview for tribal audiences</div>
          </div>
          <div class="topic-card" data-topic="multipliers">
            <div class="topic-card-title">Tribal-specific multipliers</div>
            <div class="topic-card-sub">Why we can't just copy IMPLAN</div>
          </div>
          <div class="topic-card" data-topic="council_briefing">
            <div class="topic-card-title">Briefing Tribal Council</div>
            <div class="topic-card-sub">How to explain results in 10 minutes</div>
          </div>
          <div class="topic-card" data-topic="data_sources">
            <div class="topic-card-title">Data sovereignty</div>
            <div class="topic-card-sub">What goes in, what stays protected</div>
          </div>
          <div class="topic-card" data-topic="law_context">
            <div class="topic-card-title">Federal Indian law context</div>
            <div class="topic-card-sub">Sovereignty, jurisdiction, and data</div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Chat Main Panel -->
    <main class="chat-main">
      
      <div class="chat-header">
        <div class="chat-header-left">
          <div class="chat-mode-indicator">Tribal Economic Impact</div>
          <span class="chat-session-label">Mockup Session ¬∑ Front-end only</span>
        </div>
        <div class="chat-actions">
          <button class="chat-action-btn" id="exportBtn">Export</button>
          <button class="chat-action-btn" id="clearBtn">Clear</button>
        </div>
      </div>

      <div class="chat-body" id="chatBody">
        <div class="chat-intro" id="chatIntro">
          <div class="chat-intro-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            </svg>
          </div>
          <h3>Welcome to Cedar</h3>
          <p>
            Click a topic on the left, use a quick prompt below, or type your own question about TEIM, tribal economic impact, or how to communicate results.
          </p>
        </div>
      </div>

      <div class="chat-input-area">
        <div class="quick-prompts">
          <button class="quick-prompt" data-prompt="Explain TEIM like I'm new to economic impact.">
            "Explain TEIM simply"
          </button>
          <button class="quick-prompt" data-prompt="How do I explain this chart to elders?">
            "How do I brief elders?"
          </button>
          <button class="quick-prompt" data-prompt="What's a reservation multiplier?">
            "What's a multiplier?"
          </button>
        </div>
        <div class="input-row">
          <input 
            type="text" 
            class="chat-input" 
            id="chatInput"
            placeholder="Ask about TEIM, multipliers, federal Indian law‚Ä¶ (Enter to send)"
          >
          <button class="send-btn" id="sendBtn">
            Send
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </div>
      </div>
    </main>
  </div>

  <section class="design-notes">
    <h2>Cedar Prototype ‚Äî Francesca‚Äôs Chatbot Deliverable</h2>
    
    <div class="callout">
      <strong>This is a front-end mockup only.</strong> The scripted responses show how conversations could flow. Your Python chatbot will eventually replace the JavaScript that generates answers.
    </div>

    <h3>How This Maps to Your Deliverable</h3>
    <ul>
      <li>Topic-based responses (left sidebar) ‚Üí matches your ‚Äúorganized by topic‚Äù requirement</li>
      <li>Quick prompts ‚Üí examples of reusable, canned question templates</li>
      <li>Typing indicator + timestamps ‚Üí basic UX polish for a real policy tool</li>
      <li>Export/Clear ‚Üí placeholders for saving a briefing and resetting a session</li>
    </ul>

    <h3>Quality-of-Life Features Shown</h3>
    <ul>
      <li><strong>Topic cards with hover states:</strong> subtle left accent bar and shadow on hover</li>
      <li><strong>Typing indicator:</strong> ‚ÄúCedar is thinking‚Ä¶‚Äù with animated dots</li>
      <li><strong>Message animations:</strong> fade + slide in for each new message</li>
      <li><strong>Quick prompts:</strong> click once to send a pre-filled question instantly</li>
      <li><strong>Session indicator:</strong> clearly labeled as a mockup session at the top</li>
      <li><strong>Export (print-to-PDF) button:</strong> lets you save a conversation mock as a PDF</li>
    </ul>

    <h3>Technical Notes</h3>
    <ul>
      <li>The <code>TOPIC_RESPONSES</code> and <code>KEYWORD_RESPONSES</code> objects below mirror the JSON/YAML bank you‚Äôll use in Python.</li>
      <li>All styling uses CSS variables, so you can update colors globally from <code>:root</code>.</li>
      <li>When you switch to a Python backend, you only need to replace <code>getKeywordReply()</code> and the topic response logic with API calls.</li>
    </ul>

    <h3>Your Chatbot Deliverable Checklist</h3>
    <ul>
      <li>‚òê Topic-based response organization (TEIM, multipliers, law, data)</li>
      <li>‚òê Follow-up awareness and suggestive next questions</li>
      <li>‚òê Tone calibrated for tribal policy and leadership audiences</li>
      <li>‚òê Clear internal documentation for adding/editing content</li>
      <li>‚òê Simple local run or lightweight web deployment</li>
    </ul>
  </section>

</div>

<footer>
  <p>Tribal Economic Impact Platform ‚Äî Powered by TEIM‚Ñ¢</p>
  <p class="tagline">Sovereignty-aware data and analysis for tribal nations</p>
</footer>

<script>
// SCRIPTED RESPONSES
const TOPIC_RESPONSES = {
  teim_intro: {
    user: "What is TEIM actually doing for our Nation?",
    bot: [
      `TEIM is a tribal-first economic impact system. Instead of copying state or county models, it builds around how your Nation actually governs, spends, and circulates money.`,
      `When a councilmember asks "What does this number mean?" ‚Äî TEIM answers:\n\n‚Ä¢ How dollars move through tribal government, enterprises, and the community\n‚Ä¢ What jobs, wages, and business activity those dollars support\n‚Ä¢ How impact differs on tribal land versus surrounding areas\n\nIt's less about generic multipliers and more about telling a sovereignty-aware story of your economic footprint.`
    ]
  },
  multipliers: {
    user: "Why do we need tribal-specific multipliers instead of IMPLAN?",
    bot: [
      `Most off-the-shelf models assume state and county boundaries, not tribal jurisdiction. That means they often understate tribal enterprise impact, mis-assign jobs to counties instead of tribal land, and miss flows between tribal government and households.`,
      `Tribal-specific multipliers do three things differently:\n\n1. Treat the Tribe as a government with its own fiscal powers\n2. Use tribal data and economic zones instead of only county data\n3. Respect tribal boundaries when tracking where impact lands`,
      `For your finance officer: "IMPLAN is fine for state budgeting, but it wasn't built for sovereignty. TEIM is."`
    ]
  },
  council_briefing: {
    user: "How do I explain TEIM to Tribal Council in 10 minutes?",
    bot: [
      `One structure that works:\n\n1. Purpose: "This tool shows our economic footprint as a sovereign Nation, not just a business."\n2. Tie to decisions: "It helps us compare scenarios ‚Äî new projects, debt, federal funding ‚Äî in our own terms."\n3. Concrete example: "If we invest $X in this program, TEIM estimates Y jobs and Z in income on tribal land."`,
      `Council doesn't need the formulas. They need:\n\n‚Ä¢ What decision this helps with\n‚Ä¢ Why tribal-specific modeling matters\n‚Ä¢ What could change if we ignore our unique structure`
    ]
  },
  data_sources: {
    user: "What data goes into TEIM, and what stays sovereign?",
    bot: [
      `Inputs typically include tribal financial and enterprise data (under data-sharing agreements), public sources like Tribal Economic Zones, and carefully chosen external benchmarks for comparison.`,
      `The core principle is sovereignty over data:\n\n‚Ä¢ The Tribe decides what can be shared externally\n‚Ä¢ Internal datasets stay under tribal control\n‚Ä¢ Public-facing results protect sensitive details while still telling a powerful story`
    ]
  },
  law_context: {
    user: "How does federal Indian law show up in this model?",
    bot: [
      `Federal Indian law shapes where the economy ‚Äúcounts.‚Äù Jurisdiction affects which government can tax or regulate activity, how trust land is treated, and how federal funding rules apply.`,
      `TEIM bakes in:\n\n‚Ä¢ Tribal vs. state vs. federal roles\n‚Ä¢ Trust vs. fee status\n‚Ä¢ The way sovereignty redirects economic flows\n\nThe legal context matters because it changes the story the numbers are telling.`
    ]
  }
};

const KEYWORD_RESPONSES = [
  {
    keywords: ["multiplier", "multipliers", "enterprise", "reservation"],
    reply: `Multipliers tell us how one dollar ripples out. Tribal-specific multipliers ask, "How does a dollar move through a sovereign Nation, not just a county?" That's why TEIM treats tribal government, enterprises, and households as one connected system.`
  },
  {
    keywords: ["federal", "indian law", "jurisdiction", "sovereign", "sovereignty"],
    reply: `Federal Indian law shapes who has power over land, taxation, and services. TEIM uses sovereignty and jurisdiction as part of the logic for where impact shows up and which government structures it flows through.`
  },
  {
    keywords: ["council", "elders", "brief", "explain"],
    reply: `With council and elders, keep it concrete: what decision this helps with, what changes in people's lives, and how this model centers the Nation's own data instead of only state or county numbers.`
  },
  {
    keywords: ["data", "sources", "confidential", "privacy"],
    reply: `Most sensitive data comes from the Tribe and stays under tribal control. Public data is layered on top, not used as a replacement. The principle: sovereignty over data first, then modeling.`
  }
];

const DEFAULT_FALLBACK = `I'll treat this as a design prompt: in the real version, this would route to a TEIM-aware answer bank. Try clicking a topic on the left or ask about multipliers, sovereignty, or data sources.`;

// DOM ELEMENTS
const chatBody = document.getElementById('chatBody');
const chatInput = document.getElementById('chatInput');
const sendBtn = document.getElementById('sendBtn');
const chatIntro = document.getElementById('chatIntro');
const clearBtn = document.getElementById('clearBtn');
const exportBtn = document.getElementById('exportBtn');

// HELPERS
function showIntro() {
  if (chatIntro && !chatBody.contains(chatIntro)) {
    chatBody.innerHTML = '';
    chatIntro.style.display = 'block';
    chatBody.appendChild(chatIntro);
  } else if (chatIntro) {
    chatIntro.style.display = 'block';
  }
}

function hideIntro() {
  if (chatIntro) chatIntro.style.display = 'none';
}

function getTimestamp() {
  return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
}

function appendMessage(sender, text) {
  hideIntro();
  const row = document.createElement('div');
  row.className = `message-row ${sender}`;

  const avatar = document.createElement('div');
  avatar.className = 'message-avatar';
  avatar.textContent = sender === 'bot' ? 'CE' : 'You';

  const content = document.createElement('div');
  content.className = 'message-content';

  const bubble = document.createElement('div');
  bubble.className = 'message-bubble';
  bubble.textContent = text;

  const meta = document.createElement('div');
  meta.className = 'message-meta';
  meta.textContent = sender === 'bot' ? `Cedar ¬∑ ${getTimestamp()}` : getTimestamp();

  content.appendChild(bubble);
  content.appendChild(meta);
  row.appendChild(avatar);
  row.appendChild(content);
  chatBody.appendChild(row);
  chatBody.scrollTop = chatBody.scrollHeight;
}

function showTyping() {
  hideIntro();
  const row = document.createElement('div');
  row.className = 'message-row bot';
  row.id = 'typingRow';

  const avatar = document.createElement('div');
  avatar.className = 'message-avatar';
  avatar.textContent = 'CE';

  const indicator = document.createElement('div');
  indicator.className = 'typing-indicator';
  indicator.innerHTML = `
    <div class="typing-dots"><span></span><span></span><span></span></div>
    <span class="typing-text">Cedar is thinking‚Ä¶</span>
  `;

  row.appendChild(avatar);
  row.appendChild(indicator);
  chatBody.appendChild(row);
  chatBody.scrollTop = chatBody.scrollHeight;
}

function hideTyping() {
  const typingRow = document.getElementById('typingRow');
  if (typingRow) typingRow.remove();
}

function appendBotParagraphs(paragraphs) {
  let delay = 0;
  paragraphs.forEach((p, i) => {
    setTimeout(() => {
      if (i === 0) hideTyping();
      appendMessage('bot', p);
    }, delay);
    delay += 600;
  });
}

function getKeywordReply(text) {
  const lower = text.toLowerCase();
  for (const block of KEYWORD_RESPONSES) {
    if (block.keywords.some(k => lower.includes(k))) {
      return block.reply;
    }
  }
  return DEFAULT_FALLBACK;
}

// HANDLERS
function handleTopicClick(topicKey) {
  const topic = TOPIC_RESPONSES[topicKey];
  if (!topic) return;
  appendMessage('user', topic.user);
  showTyping();
  setTimeout(() => {
    appendBotParagraphs(topic.bot);
  }, 800);
}

function handleSend() {
  const text = chatInput.value.trim();
  if (!text) return;
  appendMessage('user', text);
  chatInput.value = '';
  showTyping();
  setTimeout(() => {
    hideTyping();
    const reply = getKeywordReply(text);
    appendMessage('bot', reply);
  }, 1000);
}

function handleClear() {
  chatBody.innerHTML = '';
  showIntro();
}

function handleExport() {
  // Simple print-to-PDF as a placeholder for real export
  window.print();
}

// EVENT LISTENERS
sendBtn.addEventListener('click', handleSend);

chatInput.addEventListener('keydown', e => {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    handleSend();
  }
});

document.querySelectorAll('.topic-card').forEach(card => {
  card.addEventListener('click', () => {
    const topicKey = card.getAttribute('data-topic');
    handleTopicClick(topicKey);
  });
});

document.querySelectorAll('.quick-prompt').forEach(btn => {
  btn.addEventListener('click', () => {
    const prompt = btn.getAttribute('data-prompt');
    if (prompt) {
      chatInput.value = prompt;
      handleSend();
    }
  });
});

if (clearBtn) clearBtn.addEventListener('click', handleClear);
if (exportBtn) exportBtn.addEventListener('click', handleExport);
</script>

</body>
</html>
